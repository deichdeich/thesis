(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     28059,        702]
NotebookOptionsPosition[     26690,        655]
NotebookOutlinePosition[     27048,        671]
CellTagsIndexPosition[     27005,        668]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.661018998324171*^9, 3.661019012620517*^9}, {
   3.661019090285071*^9, 3.661019112437189*^9}, 3.6611824981689787`*^9, {
   3.661221036612853*^9, 3.6612210373406153`*^9}}],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\</Users/alexdeich/thesis/code/mine/ThesisTools.m\>\""}]], "Input"],

Cell["\<\
About energy and angular momentum of particles- track \
t\[CloseCurlyQuote][tau] and p\[CloseCurlyQuote][tau] and recalculate Ee and \
Jz at each timestep, to get an \[OpenCurlyQuote]instantaneous\
\[CloseCurlyQuote] conserved quantity?  no idea if this is valid.  For now, I\
\[CloseCurlyQuote]m just going to say that the newtonian contribution is a \
small perturbation and that the particle retains its angular momentum and \
energy.\
\>", "Text",
 CellChangeTimes->{{3.661206937052455*^9, 3.661206958524664*^9}, {
  3.6612083767831783`*^9, 3.661208377069314*^9}, {3.661209031673897*^9, 
  3.661209036982801*^9}, {3.661209073518804*^9, 3.661209090087718*^9}, {
  3.661210387311767*^9, 3.6612104088460207`*^9}, {3.661211500247316*^9, 
  3.661211500572442*^9}, {3.661219531354106*^9, 3.661219572783402*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SingleParticleDerivativeVector", "[", 
   RowBox[{
   "state_", ",", "consts_", ",", "i_", ",", "t_", ",", "M_", ",", "a_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "f", ",", "Jz", ",", "Ee", ",", "r", ",", "rad", ",", "radmotion", ",", 
      "rd", ",", "phi", ",", "G"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Ee", " ", "=", " ", 
      RowBox[{"consts", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Jz", " ", "=", " ", 
      RowBox[{"consts", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "3"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rad", " ", "=", " ", 
      RowBox[{"xy2rad", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"state", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"state", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1", ",", "2"}], "]"}], "]"}]}], "}"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"r", " ", "=", " ", 
      RowBox[{"rad", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"phi", " ", "=", " ", 
      RowBox[{"rad", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"radmotion", "=", 
      RowBox[{"xy2radMotion", "[", 
       RowBox[{
        RowBox[{"state", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"SingleParticleNewtonianForce", "[", 
         RowBox[{"state", ",", "consts", ",", "i"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"f", "=", 
      RowBox[{"{", 
       RowBox[{"r", ",", 
        RowBox[{"radmotion", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "phi", ",", 
        RowBox[{"radmotion", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"G", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"-", "3"}], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   RowBox[{"a", "[", "t", "]"}]}], " ", "Ee"}], "+", "Jz"}], 
                ")"}], "2"], " ", "M"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  SuperscriptBox[
                   RowBox[{"a", "[", "t", "]"}], "2"]}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "4"}], "+", 
                   SuperscriptBox["Ee", "2"]}], ")"}]}], "+", 
                SuperscriptBox["Jz", "2"]}], ")"}], " ", 
              RowBox[{"f", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "-", 
             RowBox[{"4", " ", "M", " ", 
              SuperscriptBox[
               RowBox[{"f", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "2"]}]}], 
            RowBox[{"4", " ", 
             SuperscriptBox[
              RowBox[{"f", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "4"]}]], "+", 
           RowBox[{"radmotion", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "1"}], "]"}], "]"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"a", "[", "t", "]"}], "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"a", "[", "t", "]"}], " ", "Ee"}], "-", "Jz"}], 
                    ")"}], " ", "M"}], "+", 
                  RowBox[{
                   RowBox[{"f", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"a", "[", "t", "]"}]}], "Ee"}], "+", "Jz"}], 
                    ")"}], " ", 
                    SuperscriptBox["M", "2"]}], "+", 
                    RowBox[{
                    RowBox[{"f", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", 
                    RowBox[{"a", "[", "t", "]"}], "Ee", " ", "M"}], "-", 
                    RowBox[{"4", " ", "Jz", " ", "M"}], "+", 
                    RowBox[{"Jz", " ", 
                    RowBox[{"f", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
                 ")"}], " ", 
                RowBox[{"f", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"f", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "2"], " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"a", "[", "t", "]"}], "2"], "-", 
                   RowBox[{"2", " ", "M", " ", 
                    RowBox[{"f", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "+", 
                   SuperscriptBox[
                    RowBox[{"f", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "2"]}], ")"}], "2"]}], 
               ")"}]}], ")"}]}], "+", 
           RowBox[{"radmotion", "[", 
            RowBox[{"[", 
             RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], "}"}]}], "}"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"G2xy", "[", 
       RowBox[{"G", ",", "r", ",", "phi"}], "]"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.661021036876217*^9, 3.66102104510601*^9}, {
   3.661021122470071*^9, 3.661021190291133*^9}, {3.66102126654963*^9, 
   3.6610212683723097`*^9}, {3.6611800048006163`*^9, 3.661180054460576*^9}, {
   3.661180578422948*^9, 3.661180817041915*^9}, {3.661181079089951*^9, 
   3.661181092034609*^9}, {3.661181154223468*^9, 3.661181156004098*^9}, {
   3.661181231308049*^9, 3.661181231625979*^9}, {3.661181263757103*^9, 
   3.661181279212995*^9}, {3.661181495794681*^9, 3.661181568737204*^9}, {
   3.661181730286179*^9, 3.661181733737774*^9}, 3.661181808305591*^9, {
   3.661182222022386*^9, 3.661182250403417*^9}, {3.661182281061129*^9, 
   3.6611823063061543`*^9}, {3.661182390980476*^9, 3.6611824207846327`*^9}, {
   3.661182468271002*^9, 3.661182471241571*^9}, {3.661182548352944*^9, 
   3.661182591456215*^9}, {3.661219787392508*^9, 3.661219804802845*^9}, {
   3.661220277839472*^9, 3.66122028244602*^9}, {3.661220368915249*^9, 
   3.661220386659871*^9}, {3.6612204284436903`*^9, 3.661220455068638*^9}, {
   3.661222951602722*^9, 3.6612229537293463`*^9}, {3.661224724844037*^9, 
   3.6612247684040127`*^9}, {3.6612249324176207`*^9, 3.661225004015497*^9}, {
   3.6612252314238234`*^9, 3.6612253095459137`*^9}, {3.6612271440270767`*^9, 
   3.6612271506307697`*^9}, {3.661227197130197*^9, 3.6612272507672377`*^9}, {
   3.661227381782366*^9, 3.6612274215156927`*^9}, {3.661228096155837*^9, 
   3.661228098015794*^9}, {3.661228131983819*^9, 3.661228132646892*^9}, {
   3.661266099309689*^9, 3.661266242233859*^9}, {3.661266331641553*^9, 
   3.661266336613144*^9}, {3.66126642664292*^9, 3.661266428407119*^9}, {
   3.661266477486751*^9, 3.661266485059705*^9}, {3.661903896033559*^9, 
   3.661904022383177*^9}, {3.66190417679091*^9, 3.6619042092787733`*^9}, {
   3.661904345561781*^9, 3.6619043898653097`*^9}, {3.661906288530879*^9, 
   3.661906296874309*^9}, {3.6619068486576223`*^9, 3.6619068528653708`*^9}, 
   3.661910621518114*^9, {3.661910856200624*^9, 3.661910870232136*^9}, 
   3.661911625012127*^9, {3.661912771671836*^9, 3.661912776828493*^9}, {
   3.66191364642306*^9, 3.661913648567103*^9}, {3.661913895081843*^9, 
   3.6619139221988792`*^9}, {3.661973744455749*^9, 3.6619737562977343`*^9}}],

Cell[TextData[{
 "State vector has ",
 StyleBox["{{{x,y},{xd,yd}},...}", "Input"]
}], "Text",
 CellChangeTimes->{{3.661219662209334*^9, 3.661219764150419*^9}, {
  3.661223030855898*^9, 3.661223031312068*^9}, {3.661266280947441*^9, 
  3.6612662897080517`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", "x_", "]"}], ":=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InitVecs", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "7.5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.", ",", "0."}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "7.5"}], ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "7.5"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mjze", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "5", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "5", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "5", ",", "7"}], "}"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.661180934015669*^9, 3.6611809858609943`*^9}, {
   3.6611810237386723`*^9, 3.661181063543322*^9}, {3.661181160261991*^9, 
   3.6611811792831984`*^9}, {3.6611812343243856`*^9, 3.661181234926186*^9}, {
   3.661181345194935*^9, 3.661181348310831*^9}, {3.6611814630469*^9, 
   3.661181466954811*^9}, {3.6611825388646717`*^9, 3.661182546292976*^9}, {
   3.661211511172675*^9, 3.661211524116724*^9}, {3.661219648719656*^9, 
   3.6612196585646133`*^9}, {3.661219771852314*^9, 3.6612197787408953`*^9}, {
   3.6612204779216633`*^9, 3.6612204821980753`*^9}, {3.661220517707917*^9, 
   3.6612205214622507`*^9}, {3.661220577917206*^9, 3.661220583416046*^9}, {
   3.661220620495223*^9, 3.661220625217514*^9}, {3.661220755393059*^9, 
   3.66122075818638*^9}, {3.661221103789085*^9, 3.661221104105607*^9}, {
   3.661222996928956*^9, 3.6612230141606627`*^9}, {3.661224406799575*^9, 
   3.661224429364461*^9}, {3.6612245056680737`*^9, 3.6612245170900784`*^9}, {
   3.661224560070445*^9, 3.6612245690469427`*^9}, {3.661225106781859*^9, 
   3.6612251220954933`*^9}, {3.661266345071506*^9, 3.661266383654216*^9}, 
   3.6618845319193373`*^9, {3.661884629724736*^9, 3.661884650215891*^9}, {
   3.661885318710806*^9, 3.6618853219426117`*^9}, {3.6618853584008017`*^9, 
   3.6618853624509563`*^9}, 3.66188677675751*^9, {3.661904050559553*^9, 
   3.661904070375702*^9}, {3.661904445645013*^9, 3.6619045008517923`*^9}, {
   3.661904568268703*^9, 3.6619045684250383`*^9}, {3.661904631799058*^9, 
   3.6619046976951942`*^9}, {3.66190486063907*^9, 3.66190488790661*^9}, {
   3.661908229340776*^9, 3.661908243556718*^9}, {3.661909104662949*^9, 
   3.661909106759919*^9}, {3.661913183601075*^9, 3.6619131837436132`*^9}, {
   3.661913224069326*^9, 3.661913266785823*^9}, {3.661913443388667*^9, 
   3.661913446664876*^9}, {3.661913526197399*^9, 3.661913538539475*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"UpdateStateVectorsRK4", "[", 
   RowBox[{
   "state_", ",", "consts_", ",", "tn_", ",", "dt_", ",", "M_", ",", "a_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "Nparticles", ",", "NewState", ",", "i", ",", "k1state", ",", "k2state", 
      ",", "k3state", ",", "k4state", ",", "k1", ",", "k2", ",", "k3", ",", 
      "k4"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Nparticles", " ", "=", " ", 
      RowBox[{"Length", "[", "state", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"NewState", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", "0", "}"}], ",", "Nparticles"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", "Nparticles"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"k1state", "=", "state"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k2state", "=", "state"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k3state", "=", "state"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k4state", "=", "state"}], ";", "\[IndentingNewLine]", 
        RowBox[{"k1", "=", 
         RowBox[{"dt", " ", 
          RowBox[{"SingleParticleDerivativeVector", "[", 
           RowBox[{"k1state", ",", "consts", ",", "i", ",", 
            RowBox[{"tn", "+", "dt"}], ",", "M", ",", "a"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"k2state", "[", 
          RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"state", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "+", 
          RowBox[{"k1", "/", "2"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"k2", " ", "=", " ", 
         RowBox[{"dt", " ", 
          RowBox[{"SingleParticleDerivativeVector", "[", 
           RowBox[{"k2state", ",", "consts", ",", "i", ",", 
            RowBox[{"tn", "+", 
             RowBox[{"dt", "/", "2"}]}], ",", "M", ",", "a"}], "]"}]}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"k3state", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"state", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "+", 
          RowBox[{"k2", "/", "2"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"k3", " ", "=", " ", 
         RowBox[{"dt", " ", 
          RowBox[{"SingleParticleDerivativeVector", "[", 
           RowBox[{"k3state", ",", "consts", ",", "i", ",", 
            RowBox[{"tn", "+", 
             RowBox[{"dt", "/", "2"}]}], ",", "M", ",", "a"}], "]"}]}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"k4state", "[", 
          RowBox[{"[", "i", "]"}], "]"}], " ", "=", 
         RowBox[{
          RowBox[{"state", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "+", "k3"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"k4", " ", "=", " ", 
         RowBox[{"dt", " ", 
          RowBox[{"SingleParticleDerivativeVector", "[", 
           RowBox[{"k4state", ",", "consts", ",", "i", ",", 
            RowBox[{"tn", "+", "dt"}], ",", "M", ",", "a"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NewState", "[", 
          RowBox[{"[", "i", "]"}], "]"}], " ", "=", " ", 
         RowBox[{
          RowBox[{"state", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "/", "3"}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"k1", "/", "2"}], "+", "k2", "+", "k3", "+", 
             RowBox[{"k4", "/", "2"}]}], ")"}]}]}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "NewState", "]"}], ";"}]}], "\[IndentingNewLine]",
    "]"}]}]], "Input",
 CellChangeTimes->{{3.661906749100457*^9, 3.661906844119203*^9}, {
  3.661906876558663*^9, 3.6619071837884903`*^9}, {3.661907520450165*^9, 
  3.661907524740754*^9}, {3.661907616758732*^9, 3.661907619174954*^9}, {
  3.661908072657461*^9, 3.661908087361684*^9}, {3.661908199699484*^9, 
  3.661908199759334*^9}, {3.661908905860096*^9, 3.6619089602442837`*^9}, {
  3.661909706417542*^9, 3.661909714472493*^9}, {3.661909745397874*^9, 
  3.661909779550205*^9}, {3.6619098175638533`*^9, 3.6619098182669067`*^9}, {
  3.661910833309401*^9, 3.661910834255772*^9}, {3.66191418887617*^9, 
  3.66191422733435*^9}, {3.6619147645206833`*^9, 3.661914792374124*^9}, {
  3.661967904578472*^9, 3.661967977214326*^9}, {3.661968132608821*^9, 
  3.661968136556081*^9}, {3.661968174017919*^9, 3.661968296140061*^9}, {
  3.661968351526144*^9, 3.661968367468802*^9}, {3.661968411923094*^9, 
  3.661968433773885*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TimeEvolveRK4", "[", 
   RowBox[{
   "state_", ",", "consts_", ",", "t0_", ",", "dt_", ",", "timesteps_", ",", 
    "M_", ",", "a_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"wholestory", ",", "tn", ",", "n", ",", "NewVecs"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"wholestory", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", "timesteps"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tn", " ", "=", "t0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"NewVecs", " ", "=", " ", "state"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"wholestory", "[", 
       RowBox[{"[", "1", "]"}], "]"}], " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{"t0", ",", "state"}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"n", "=", "2"}], ",", 
       RowBox[{"n", "\[LessEqual]", " ", "timesteps"}], ",", 
       RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NewVecs", " ", "=", " ", 
         RowBox[{"UpdateStateVectorsRK4", "[", 
          RowBox[{
          "NewVecs", ",", "consts", ",", "tn", ",", "dt", ",", "M", ",", 
           "a"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tn", "=", 
         RowBox[{"tn", "+", "dt"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"wholestory", "[", 
          RowBox[{"[", "n", "]"}], "]"}], "=", 
         RowBox[{"{", 
          RowBox[{"tn", ",", "NewVecs"}], "}"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "wholestory", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.661907243638729*^9, 3.6619072454025927`*^9}, {
   3.661907452970455*^9, 3.661907513194714*^9}, {3.6619075471012163`*^9, 
   3.661907610935196*^9}, {3.661907653025441*^9, 3.661907931748625*^9}, {
   3.661908300292882*^9, 3.661908327800398*^9}, {3.6619083947915707`*^9, 
   3.661908404757111*^9}, {3.6619089944284077`*^9, 3.6619089948187113`*^9}, 
   3.661911673105164*^9, {3.661911802070684*^9, 3.661911806338866*^9}, {
   3.6619119366137114`*^9, 3.6619119433239193`*^9}, {3.6619121133299303`*^9, 
   3.6619121251438293`*^9}, {3.661912807990933*^9, 3.661912812931632*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", " ", "=", " ", 
   RowBox[{"TimeEvolveRK4", "[", 
    RowBox[{
    "InitVecs", ",", "mjze", ",", "0", ",", "0.001", ",", "1000", ",", "1", 
     ",", "a"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661908130767967*^9, 3.661908176604555*^9}, {
  3.661909010023385*^9, 3.66190901270537*^9}, {3.661912848996427*^9, 
  3.6619128491375523`*^9}, {3.661968443041316*^9, 3.6619684431655273`*^9}, {
  3.6619685277047997`*^9, 3.661968530544405*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{3.661912181185377*^9, 3.661912220709484*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"OneParticle", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"7.5", ",", "0."}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.", ",", "0.5357145"}], "}"}]}], "}"}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.661969229243555*^9, 3.661969232000886*^9}, {
  3.661969315310321*^9, 3.661969315553543*^9}, {3.661969456900737*^9, 
  3.6619694723003273`*^9}, {3.661971918446184*^9, 3.661971930918483*^9}, {
  3.6619727313184223`*^9, 3.661972737696492*^9}, {3.6619741150274267`*^9, 
  3.661974118077097*^9}, {3.6619746217764378`*^9, 3.661974622089753*^9}, {
  3.66197472907751*^9, 3.661974729305519*^9}, {3.661974813382657*^9, 
  3.661974813886216*^9}, {3.661974910374373*^9, 3.6619749111426697`*^9}, {
  3.661975209860476*^9, 3.661975210055195*^9}, {3.661976120849227*^9, 
  3.6619761221808567`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mjze1", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"1.", ",", "5.", ",", "7."}], "}"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.661969476668129*^9, 3.661969481317906*^9}, {
  3.661969599884872*^9, 3.661969601293391*^9}, {3.661971932967244*^9, 
  3.66197193537458*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"OneParticleData", " ", "=", " ", 
   RowBox[{"TimeEvolveRK4", "[", 
    RowBox[{
    "OneParticle", ",", "mjze1", ",", "0", ",", "0.001", ",", "300000", ",", 
     "1", ",", "a"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6619700983321543`*^9, 3.661970109783105*^9}, {
   3.661970495932679*^9, 3.661970496108878*^9}, {3.6619707663312283`*^9, 
   3.661970772075281*^9}, {3.661974120569296*^9, 3.661974120773839*^9}, 
   3.66197481607506*^9, {3.6619750220665407`*^9, 3.661975022464684*^9}, {
   3.66197506011808*^9, 3.6619750735553837`*^9}, 3.661975354542246*^9, {
   3.661975395999979*^9, 3.661975397539109*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"OneParticleData", "[", 
  RowBox[{"[", 
   RowBox[{"1", ",", "2", ",", "1", ",", "1", ",", "1"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.661970262724069*^9, 3.661970310340699*^9}}],

Cell[BoxData["7.5`"], "Output",
 CellChangeTimes->{{3.6619702664336643`*^9, 3.6619703106683397`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"xyplot", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"OneParticleData", "[", 
       RowBox[{"[", 
        RowBox[{"j", ",", "2", ",", "1", ",", "1", ",", "1"}], "]"}], "]"}], 
      ",", 
      RowBox[{"OneParticleData", "[", 
       RowBox[{"[", 
        RowBox[{"j", ",", "2", ",", "1", ",", "1", ",", "2"}], "]"}], "]"}]}],
      "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "300000"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.661970314599703*^9, 3.6619704089341307`*^9}, {
  3.661970647074877*^9, 3.661970664079918*^9}, {3.661972082868738*^9, 
  3.661972083968567*^9}, {3.661974507385398*^9, 3.6619745087898912`*^9}, {
  3.661975968912449*^9, 3.66197597157607*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"pltrng", "=", "10"}], ";"}]], "Input",
 CellChangeTimes->{{3.661970474021943*^9, 3.6619704798495502`*^9}, {
   3.6619730407281723`*^9, 3.6619730614626207`*^9}, 3.661975862110449*^9, 
   3.661975919333066*^9}],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"{", "xyplot", "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "pltrng"}], ",", "pltrng"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "pltrng"}], ",", "pltrng"}], "}"}]}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.661970404387864*^9, 3.661970427221394*^9}, {
  3.6619704713919897`*^9, 3.6619704716607533`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"T", "=", "0."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "=", "7.5"}], ";"}]}], "Input",
 CellChangeTimes->{{3.661972682683742*^9, 3.66197271178799*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Td", "=", "0.0714286"}], ";"}]], "Input",
 CellChangeTimes->{{3.661972694761675*^9, 3.661972705786874*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rd", "=", "0."}]], "Input",
 CellChangeTimes->{{3.661972708200799*^9, 3.661972709726734*^9}}],

Cell[BoxData["0.`"], "Output",
 CellChangeTimes->{3.661972713562746*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"xd", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Cos", "[", "T", "]"}], " ", "rd"}], "-", 
   RowBox[{"r", " ", 
    RowBox[{"Sin", "[", "T", "]"}], " ", "Td"}]}]}]], "Input",
 CellChangeTimes->{3.6619727193391027`*^9}],

Cell[BoxData["0.`"], "Output",
 CellChangeTimes->{3.6619727196812563`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"yd", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Sin", "[", "T", "]"}], " ", "rd"}], "+", 
   RowBox[{
    RowBox[{"Cos", "[", "T", "]"}], " ", "r", " ", "Td"}]}]}]], "Input",
 CellChangeTimes->{3.661972721430155*^9}],

Cell[BoxData["0.5357145`"], "Output",
 CellChangeTimes->{3.661972721782296*^9}]
}, Open  ]]
},
WindowSize->{1002, 719},
WindowMargins->{{10, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 10, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 268, 4, 28, "Input"],
Cell[829, 26, 102, 2, 28, "Input"],
Cell[934, 30, 819, 13, 68, "Text"],
Cell[1756, 45, 8743, 201, 340, "Input"],
Cell[10502, 248, 259, 6, 31, "Text"],
Cell[10764, 256, 2991, 63, 63, "Input"],
Cell[13758, 321, 4840, 106, 352, "Input"],
Cell[18601, 429, 2421, 54, 216, "Input"],
Cell[21025, 485, 488, 10, 28, "Input"],
Cell[21516, 497, 90, 1, 28, "Input"],
Cell[21609, 500, 894, 19, 28, "Input"],
Cell[22506, 521, 332, 8, 28, "Input"],
Cell[22841, 531, 653, 12, 28, "Input"],
Cell[CellGroupData[{
Cell[23519, 547, 214, 5, 28, "Input"],
Cell[23736, 554, 101, 1, 28, "Output"]
}, Open  ]],
Cell[23852, 558, 768, 19, 28, "Input"],
Cell[24623, 579, 243, 5, 28, "Input"],
Cell[24869, 586, 502, 15, 28, "Input"],
Cell[25374, 603, 205, 5, 46, "Input"],
Cell[25582, 610, 142, 3, 28, "Input"],
Cell[CellGroupData[{
Cell[25749, 617, 117, 2, 28, "Input"],
Cell[25869, 621, 72, 1, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25978, 627, 251, 7, 28, "Input"],
Cell[26232, 636, 74, 1, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26343, 642, 249, 7, 28, "Input"],
Cell[26595, 651, 79, 1, 28, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
